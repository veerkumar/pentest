#!/usr/bin/python

import os
import sys
import struct
import socket
while(1):
	os.system('dialog --infobox  "welcome to Network Scanner Tool" 10  30')
	os.system('sleep 1')
	os.system('dialog --menu  "Network Scanning" 20 40 5  "1" "TCP Connect Scan"   "2" "TCP FIN Scan" "3" "Ping Scan" "4" "UDP Scan" "5" "Version Detection Scan"  "6" "Stealth scan" "7" "misc" 2> /tmp/choice_netscan')
	choice_netscan=open('/tmp/choice_netscan').read(20)
	if choice_netscan != '3' : 
		os.system('dialog --inputbox "Enter the destination ip address" 10 20 2> /tmp/ip')
		ip_netscan=open('/tmp/ip').read(20)
		os.system('dialog --inputbox "Do you want to enter specific ports or do a generic scan?(p/g)" 10 20 2> /tmp/ip')
		choice_port_netcan=open('/tmp/ip').read(20)
		if choice_port_netcan == 'g':
			os.system('dialog --inputbox "Enter the destination port address" 10 20 2> /tmp/port')
			portl_netscan=' -p '+open('/tmp/port').read(20)
			portu_netscan=''
			
		else:
			os.system('dialog --inputbox "Enter the destination lower port address" 10 20 2> /tmp/port')
			portl_netscan=' -p '+open('/tmp/port').read(20)+'-'
			os.system('dialog --inputbox "Enter the destination upper port address" 10 20 2> /tmp/port')
			portu_netscan=open('/tmp/port').read(20)+' '
			

	if choice_netscan == "1" : #TCP Connect Scan
		os.system(' nmap -sT ' + ip_netscan + portl_netscan+portu_netscan)

	elif choice_netscan == "2" : #TCP FIN Scan
		
		os.system(' nmap -sF ' + ip_netscan  + portl_netscan+portu_netscan)

	elif choice_netscan == "3" : #Ping Scan
		os.system('dialog --inputbox "Do you wish to scan a range of IP addresses or a single IP address?(r/s)" 10 20 2> /tmp/ip')
		choice_ip_netscan=open('/tmp/ip').read(20)
		if choice_ip_netscan=='s':
			os.system('dialog --inputbox "Enter the IP address" 10 20 2> /tmp/ip')
			ipl_netscan=open('/tmp/ip').read(20)
			ipu_netscan=''
			diff_netscan=''
		
		else :
			os.system('dialog --inputbox "Enter the lower IP range" 10 20 2> /tmp/ip')
			ipl_netscan=str(open('/tmp/ip').read(20))
			os.system('dialog --inputbox "Enter the upper IP range" 10 20 2> /tmp/ip')
			ipu_netscan=str(open('/tmp/ip').read(20))
			diff_netscan=str(struct.unpack("!I", socket.inet_aton(ipu_netscan))[0]-struct.unpack("!I", socket.inet_aton(ipl_netscan))[0])		
			ipl_netscan=ipl_netscan+'-'
			ipu_netscan=ipu_netscan+' '			
		
		os.system(' nmap -sP ' + ipl_netscan+diff_netscan)

	elif choice_netscan == "4" : #UDP Scan
		os.system(' nmap -sU ' + ip_netscan  + portl_netscan+portu_netscan)


	elif choice_netscan == "5" : #Version Detection Scan
		os.system(' nmap -sV ' + ip_netscan  + portl_netscan+portu_netscan)

	elif choice_netscan == "6" : #Stealth Scan
		os.system(' nmap -sS ' + ip_netscan  + portl_netscan+portu_netscan)

	a = raw_input('Press Enter to continue')
	ch=os.system('dialog --yesno "Do you want to logout"  10  40')
	if ch == 0 :
		sys.exit(1)
	else:
		pass
			

